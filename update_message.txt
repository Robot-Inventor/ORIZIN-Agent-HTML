エラー時の処理等を追加し，利便性を向上させました。