<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Expires" content="86400">
        <link rel="stylesheet" type="text/css" href="../css/layout.min.css">
        <link rel="shortcut icon" href="../image/favicon.ico">
        <meta name="theme-color" content="#FF6A00">
        <title>ORIZIN Agent HTML</title>
        <meta name="description" content="オープンソースのAIアシスタント「ORIZIN Agent HTML」です。">
    </head>
    <body>
        <header>
        </header>
        <main>
            <div class="fill_panel">
                <h2>試験機能</h2>
                <search-box id="search_box"></search-box>
                <section>
                    <warning-message id="continue_check_message" content="ここにある機能は全て試験機能であり，実装が不十分な可能性があります。有効にするとデータが破損したり，動作が不安定になったり，その他の問題が生じたりする場合があります。本当に設定を変更しますか。"></warning-message>
                    <menu id="continue_check_menu">
                        <mwc-button label="はい" id="continue_button" unelevated></mwc-button><mwc-button label="いいえ（戻る）" id="back_button"></mwc-button>
                    </menu>
                </section>
                <div id="section_outer">
                    <section>
                        <i class="material_icon">text_format</i>可読性を上げる設定を追加する　<mwc-switch id="add_readable_text_setting"></mwc-switch>
                        <p class="information">
                            設定ページにテキストを読みやすくするための項目を追加します。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">power_settings_new</i>高速起動を有効にする　<mwc-switch id="fast_start"></mwc-switch>
                        <p class="information">
                            スプラッシュスクリーンをスキップし，高速起動します。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">rss_feed</i>Google News RSSを使用する　<mwc-switch id="get_news_from_google_news"></mwc-switch>
                        <p class="information">
                            ユーザーがニュースを要求した際，GoogleニュースのWEBページを開くのではなくGoogle News RSSを使用してインターネットからニュースを自動で取得します。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">two_wheeler</i>高速モードを有効にする　<mwc-switch id="use_fast_response_mode"></mwc-switch>
                        <p class="information">
                            高速かつ低負荷で応答を返すようにします。Intelligent Match機構は無効になり，適切な応答が見つからなかったことを示す「そうですか。」という応答が返される頻度が高くなります。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">feedback</i>フィードバックボタンを表示する　<mwc-switch id="show_feedback_button"></mwc-switch>
                        <p class="information">
                            メニュー内にフィードバックボタンを表示し，必要に応じてフィードバックを送信できるようになります。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">search</i>設定の検索を有効にする　<mwc-switch id="show_setting_search_box"></mwc-switch>
                        <p class="information">
                            設定ページと試験機能ページに設定の検索ボックスを追加します。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">upgrade</i>アップデートチェッカーを有効にする　<mwc-switch id="enable_update_checker"></mwc-switch>
                        <p class="information">
                            設定ページの「アップデートを確認」セクションにアップデートチェッカーボタンを表示します。
                        </p>
                    </section>
                    <section>
                        <i class="material_icon">edit</i>改善されたカスタムテーマの編集ページを使用する　<mwc-switch id="enable_improved_custom_theme_editor"></mwc-switch>
                        <p class="information">
                            設定ページのテーマセクションで「カスタムテーマの編集」を押した際に改善されたページを表示します。
                        </p>
                    </section>
                </div>
                <mwc-button label="すべてデフォルトに戻す" icon="refresh" id="refresh_button"></mwc-button>
                <mwc-dialog id="reset_check_dialog">
                    <div>設定をすべてデフォルトに戻します。よろしいですか。</div>
                    <mwc-button slot="primaryAction" dialogAction="yes">
                      はい
                    </mwc-button>
                    <mwc-button slot="secondaryAction" dialogAction="cancel">
                      キャンセル
                    </mwc-button>
                </mwc-dialog>
            </div>
        </main>
        <style>
            search-box {
                display: none;
            }

            #section_outer {
                display: none;
            }

            section {
                border-bottom: solid 0.05em var(--text);
                padding: 1em;
                padding-left: 0;
                font-weight: bold;

            }

            #refresh_button {
                float: right;
                cursor: pointer;
                padding: 0.25rem;
                border-radius: 0.25rem;
                margin-top: 2rem;
            }

            .information {
                padding-left: 1.5rem;
            }
        </style>
        <script src="../javascript/orizin_ui.min.js"></script>
        <script src="../javascript/basic.js"></script>
        <script src="../javascript/bundle.js"></script>
        <script src="/eel.js"></script>
        <script>
            const search_box = document.getElementById("search_box");

            async function read_flag(flag_name) {
                const flag_value = await eel.read_flag(flag_name)();
                document.getElementById(flag_name).checked = flag_value;
            }

            function search_setting() {
                const query = search_box.value;

                document.querySelectorAll("div.fill_panel section").forEach((element) => {
                    element.style.display = element.innerText.toLowerCase().indexOf(query.toLowerCase()) === -1 ? "none" : element.dataset.defaultDisplay;
                });
            }

            async function show_search_area() {
                if (await eel.read_flag("show_setting_search_box")()) {
                    search_box.style.display = "block";
                }
            }

            document.querySelectorAll("div.fill_panel section mwc-switch").forEach((element) => {
                read_flag(element.id);

                element.addEventListener("change", function() {
                    eel.set_flag(event.target.id, event.target.checked);
                });
            });

            document.getElementById("continue_button").addEventListener("click", function() {
                document.getElementById("section_outer").style.display = "block";
                document.getElementById("continue_check_menu").style.display = "none";
                document.getElementById("continue_check_message").content = "ここにある機能は全て試験機能であり，実装が不十分な可能性があります。有効にするとデータが破損したり，動作が不安定になったり，その他の問題が生じたりする場合があります。";
            });

            document.getElementById("back_button").addEventListener("click", function() {
                window.history.back(-1);
                return false;
            });

            document.getElementById("refresh_button").addEventListener("click", () => {
                const dialog = document.getElementById("reset_check_dialog");
                dialog.show();
                dialog.addEventListener("closed", () => {
                    if (event.detail.action === "yes") {
                        eel.reset_flag();
                        location.reload();
                    }
                });
            });

            document.querySelectorAll("div.fill_panel section").forEach((element) => {
                element.dataset.defaultDisplay = getComputedStyle(element).getPropertyValue("display");
            });

            search_box.addEventListener("input", function() {
                search_setting();
            });

            show_search_area();
        </script>
    </body>
</html>
