<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Expires" content="86400">
        <link rel="stylesheet" type="text/css" href="../css/layout.css">
        <link rel="shortcut icon" href="../image/favicon.ico">
        <meta name="theme-color" content="#FF6A00">
        <title>ORIZIN Agent HTML</title>
        <meta name="description" content="オープンソースのAIアシスタント「ORIZIN Agent HTML」です。">
        <!-- この行は他のページとは違うため，headタグ内の書き換えの際は注意 --><link rel="stylesheet" type="text/css" href="../css/classic.min.css">
    </head>
    <body>
        <header>
        </header>
        <main>
            <div class="fill_panel">
                <h2>カスタムテーマの編集</h2>
                <section>
                    背景色<div id="bg"></div>
                </section>
                <section>
                    影の色<div id="shadow"></div>
                </section>
                <section>
                    カードの背景色<div id="card_bg"></div>
                </section>
                <section>
                    文字色<div id="text"></div>
                </section>
                <section>
                    テーマ色<div id="theme_color"></div>
                </section>
            </div>
        </main>
        <style>
            section {
                padding: 1rem 0;
                border-top: solid 0.1rem var(--text);
            }

            section div {
                display: inline-block;
                margin-left: 2rem;
            }
        </style>
        <script src="../javascript/orizin_ui.min.js"></script>
        <script src="../javascript/basic.js"></script>
        <script src="../javascript/pickr.min.js"></script>
        <script src="/eel.js"></script>
        <script>
            let css_data = [];
            let old_css_data = [];

            async function check_current_css_theme_information() {
                css_data =  await eel.check_current_css_theme_information()();
                old_css_data = await eel.check_current_css_theme_information()();
                const swatches_values = [
                    "rgb(244, 67, 54)",
                    "rgb(233, 30, 99)",
                    "rgb(156, 39, 176)",
                    "rgb(103, 58, 183)",
                    "rgb(63, 81, 181)",
                    "rgb(33, 150, 243)",
                    "rgb(3, 169, 244)",
                    "rgb(0, 188, 212)",
                    "rgb(0, 150, 136)",
                    "rgb(76, 175, 80)",
                    "rgb(139, 195, 74)",
                    "rgb(205, 220, 57)",
                    "rgb(255, 235, 59)",
                    "rgb(255, 193, 7)"
                ];
                const components_values = {
                    preview: true,
                    opacity: true,
                    hue: true,
                    interaction: {
                        hex: true,
                        rgba: true,
                        hsla: true,
                        hsva: true,
                        cmyk: true,
                        input: true,
                        clear: true,
                        save: true,
                        cancel: true
                    }
                };
                const i18n_values = {
                    "btn:save": "決定",
                    "btn:clear": "リセット",
                    "btn:cancel": "キャンセル"
                };
                const bg = Pickr.create({
                    el: "#bg",
                    theme: "classic",
                    default: css_data[0],
                    swatches: swatches_values,
                    components: components_values,
                    i18n: i18n_values
                });
                bg.on("save", (color, instance) => {
                    css_data[0] = color.toHEXA().toString();
                    bg.hide();
                });

                const card_bg = Pickr.create({
                    el: "#card_bg",
                    theme: "classic",
                    default: css_data[1],
                    swatches: swatches_values,
                    components: components_values,
                    i18n: i18n_values
                });
                card_bg.on("save", (color, instance) => {
                    css_data[1] = color.toHEXA().toString();
                    card_bg.hide();
                });

                const text = Pickr.create({
                    el: "#text",
                    theme: "classic",
                    default: css_data[2],
                    swatches: swatches_values,
                    components: components_values,
                    i18n: i18n_values
                });
                text.on("save", (color, instance) => {
                    css_data[2] = color.toHEXA().toString();
                    text.hide();
                });

                const shadow = Pickr.create({
                    el: "#shadow",
                    theme: "classic",
                    default: css_data[3],
                    swatches: swatches_values,
                    components: components_values,
                    i18n: i18n_values
                });
                shadow.on("save", (color, instance) => {
                    css_data[3] = color.toHEXA().toString();
                    shadow.hide();
                });

                const theme_color = Pickr.create({
                    el: "#theme_color",
                    theme: "classic",
                    default: css_data[4],
                    swatches: swatches_values,
                    components: components_values,
                    i18n: i18n_values
                });
                theme_color.on("save", (color, instance) => {
                    css_data[4] = color.toHEXA().toString();
                    theme_color.hide();
                });
            }

            check_current_css_theme_information();

            window.addEventListener("beforeunload", function() {
                if (old_css_data.toString() != css_data.toString()) {
                    eel.write_custom_css_theme(css_data);
                    eel.change_theme("theme/user/custom_theme.css");
                }
            });
        </script>
    </body>
</html>
