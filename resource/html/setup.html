<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="Expires" content="86400">
        <link rel="stylesheet" type="text/css" href="../css/layout.css">
        <link rel="shortcut icon" href="../image/favicon.ico">
        <meta name="theme-color" content="#FF6A00">
        <title>ORIZIN Agent HTML</title>
        <meta name="description" content="オープンソースのAIアシスタント「ORIZIN Agent HTML」です。">
    </head>
    <body>
        <header>
        </header>
        <main>
            <div class="overlay_outer">
                <div class="overlay_inner" id="licence_card">
                    <h2><i class="material_icon">assignment</i>ライセンス</h2>
                    <p>
                        ORIZIN Agent HTMLは，MITライセンスの下に配布されています。使用するにはライセンスに同意する必要があります。(下のボックスはスクロールできます)
<pre>
MIT License

Copyright (c) 2019 - 2020 Robot-Inventor

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
</pre>
                    </p>
                    <menu>
                        <button onclick="window.close()" class="ripple_effect"><i class="material_icon">close</i>同意しない</button><button onclick="forward_card('licence_card', 'privacy_policy_card')" class="ripple_effect"><i class="material_icon">check</i>同意する</button>
                    </menu>
                </div>
                <div class="overlay_inner" id="privacy_policy_card">
                    <h2><i class="material_icon">privacy_tip</i>プライバシーポリシー</h2>
                    <p>
                        以下は，ORIZIN Agent HTMLのプライバシーポリシーです。使用するには，プライバシーポリシーに同意する必要があります。(下のボックスはスクロールできます)
<pre>
1.インターネットへの接続
ORIZIN Agent HTML（以下，「本ソフトウェア」とします。）は，本ソフトウェアそのものの基本的な動作にはインターネット接続を必要としません。

2.ユーザーの情報の取り扱い
インターネットへの接続状態に関わらず，本ソフトウェアは本ソフトウェアを使用する者（以下，「ユーザー」とします。）の情報（個人情報，非個人情報を問いません。また，ユーザーの本ソフトウェアの使用履歴及び会話の内容を含みます。以下，同じです。）をユーザー以外の者（本ソフトウェアの制作者を含みます。）に対し，ユーザーの質問を検索する機能，メモ機能及び設定の保存以外で有線，無線を問わず送信又は保存することは絶対にありません。

3.将来的な仕様の変更
将来的に本ソフトウェアの仕様が変更になりユーザーの情報を送信するようになる可能性も考えられます。その際は，必ずポップアップ等の手段によりユーザーの明示的な同意を得てからユーザーの情報を送信し，ユーザーの明示的な同意が得られない場合はユーザーの情報を一切送信せずにユーザーが本ソフトウェアを使用できるようにします。

4.例外
本ソフトウェアそのものはユーザーの情報を検索以外の目的で送信することはありませんが，WEBブラウザーのWeb Speech API及びGoogle等の本ソフトウェアが使用するサービスがユーザーの情報の送信，記録及び分析等をする可能性があります。詳細は，各サービスのプライバシーポリシー等をご確認ください。

5.会話内容の記録
本ソフトウェアは今後の開発に役立てたり、一部の機能を動作させたりするため，ユーザーに辞書データにない文章を入力された場合並びにメモ機能が使用された場合及び設定の保存に限り，ユーザーの入力した文章をローカルにresource/dictionary/unknownQuestions.txt並びにmemo.txt及びresource/setting/setting.otfd並びにresource/setting/flag.otfdとして記録します。本ソフトウェアの再配布等を行う場合は十分に気を付けてください。当該ファイルを削除しても本ソフトウェアの動作に影響は一切(設定ファイルを除く)ありません。当該ファイルの内容をGitHubのissues等で教えていただけると今後の開発の役に立ちますが，強制ではありません。

6.公式リポジトリ以外からのダウンロード
https://github.com/Robot-Inventor/ORIZIN-Agent-HTML/ 並びにそれより下の階層のURL及びそれらが提供する本ソフトウェアのダウンロードのためのURL（以下，「公式リポジトリ」とします。）よりダウンロードした本ソフトウェアはこのプライバシーポリシーに従いますが，公式リポジトリ以外からダウンロードした本ソフトウェアがこのプライバシーポリシーに従うかどうかは分かりません。心配な場合は，公式リポジトリ以外から本ソフトウェアをダウンロードしないでください。

7.プライバシーポリシーの変更
本ソフトウェアの制作者は，いつでもその意志でこのプライバシーポリシーを変更できるものとします。ただし，変更後のプライバシーポリシーが変更前にダウンロードされた本ソフトウェアに遡って適用されることはありません。
</pre>
                        <menu>
                            <button onclick="window.close()" class="ripple_effect"><i class="material_icon">close</i>同意しない</button><button onclick="forward_card('privacy_policy_card', 'ask_continue_card')" class="ripple_effect"><i class="material_icon">check</i>同意する</button>
                        </menu>
                    </p>
                </div>
                <div class="overlay_inner" id="ask_continue_card">
                    <h2><i class="material_icon">build</i>初期設定を行いますか？</h2>
                    <p>
                        これから，ORIZIN Agent HTMLの初期設定を行います。設定はスキップでき，あとから変更することもできます。設定を続行しますか？
                    </p>
                    <menu>
                        <button onclick="save_setting()" class="ripple_effect"><i class="material_icon">cancel</i>スキップ</button><button onclick="forward_card('ask_continue_card', 'theme_setting_card')" class="ripple_effect"><i class="material_icon">check</i>続行</button>
                    </menu>
                </div>
                <div class="overlay_inner" id="theme_setting_card">
                    <h2><i class="material_icon">palette</i>テーマを選択</h2>
                    <p>
                        テーマ（ORIZIN Agent HTMLの画面の配色）を選択してください。後から設定でカスタムすることができます。
                    </p>
                    <select id="theme">
                        <!-- ここの中身はJavaScriptで動的に生成 -->
                    </select>
                    <br>
                    <menu>
                        <button onclick="back_card('theme_setting_card', 'ask_continue_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="forward_card('theme_setting_card', 'user_name_setting_card')" class="ripple_effect">次へ<i class="material_icon">arrow_forward</i></button>
                    </menu>
                </div>
                <div class="overlay_inner" id="user_name_setting_card">
                    <h2><i class="material_icon">person</i>ユーザー名を設定</h2>
                    <p>
                        ユーザー名（あなたの呼び名）を入力してください。デフォルトは「ゲスト」です。
                    </p>
                    <underlined-textbox placeholder="ユーザー名を入力" id="user_name" value="ゲスト"></underlined-textbox>
                    <menu>
                        <button onclick="back_card('user_name_setting_card', 'theme_setting_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="forward_card('user_name_setting_card', 'search_engine_setting_card')" class="ripple_effect">次へ<i class="material_icon">arrow_forward</i></button>
                    </menu>
                </div>
                <div class="overlay_inner" id="search_engine_setting_card">
                    <h2><i class="material_icon">search</i>検索エンジンを選択</h2>
                    <p>
                        ORIZIN Agentがあなたの要求に応じて検索を行う際の検索エンジンを選択してください。
                    </p>
                    <select id="search_engine">
                        <option value="Google">Google(デフォルト)</option>
                        <option value="Bing">Bing</option>
                        <option value="YahooJapan">Yahoo! Japan</option>
                        <option value="Yahoo">Yahoo!</option>
                        <option value="DuckDuckGo">DuckDuckGo</option>
                    </select>
                    <br>
                    <menu>
                        <button onclick="back_card('search_engine_setting_card', 'user_name_setting_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="forward_card('search_engine_setting_card', 'news_site_url_setting_card')" class="ripple_effect">次へ<i class="material_icon">arrow_forward</i></button>
                    </menu>
                </div>
                <div class="overlay_inner" id="news_site_url_setting_card">
                    <h2><i class="material_icon">link</i>ニュースサイトのURLを設定</h2>
                    <p>
                        ORIZIN Agentがあなたの要求に応じてニュースを開く際のサイトのURLを入力してください。デフォルトはGoogleニュースです。
                    </p>
                    <underlined-textbox placeholder="URLを入力" id="news_site_url" value="https://news.google.com/?hl=ja&gl=JP&ceid=JP:ja"></underlined-textbox>
                    <menu>
                        <button onclick="back_card('news_site_url_setting_card', 'search_engine_setting_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="forward_card('news_site_url_setting_card', 'python_interpreter_setting_card')" class="ripple_effect">次へ<i class="material_icon">arrow_forward</i></button>
                    </menu>
                </div>
                <div class="overlay_inner" id="python_interpreter_setting_card">
                    <h2><i class="material_icon">api</i>インタープリターを設定</h2>
                    <p>
                        Python3のインタープリターを設定します。Python3の実行ファイルへの絶対パスかエイリアスを入力して下さい
                    </p>
                    <underlined-textbox placeholder="絶対パスかエイリアスを入力" id="python_interpreter" value="python"></underlined-textbox>
                    <menu>
                        <button onclick="back_card('python_interpreter_setting_card', 'news_site_url_setting_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="forward_card('python_interpreter_setting_card', 'setting_finished_message_card')" class="ripple_effect">次へ<i class="material_icon">arrow_forward</i></button>
                    </menu>
                </div>
                <div class="overlay_inner" id="setting_finished_message_card">
                    <h2><i class="material_icon">check</i>完了</h2>
                    <p>
                        設定が完了しました！
                    </p>
                    <menu>
                        <button onclick="back_card('setting_finished_message_card', 'news_site_url_setting_card')" class="ripple_effect"><i class="material_icon">arrow_back</i>戻る</button><button onclick="save_setting()" class="ripple_effect"><i class="material_icon">check</i>初期設定を終了</button>
                    </menu>
                </div>
                <progress value="0" max="1">0%</progress>
                <style>
                    #ask_continue_card a {
                        padding: 0;
                        margin: 0 1rem;
                    }

                    .overlay_inner {
                        margin-left: 100vw;
                    }

                    #licence_card {
                        margin-left: 0;
                    }

                    .overlay_inner pre {
                        height: 10rem;
                        border: solid 0.1rem var(--text);
                        padding: 0.5rem;
                        overflow-x: hidden;
                    }

                    .overlay_outer {
                        overflow: hidden;
                    }

                    progress {
                        width: 50vw;
                        position: absolute;
                        top: 80vh;
                        left: 25vw;
                    }
                </style>
            </div>
        </main>
        <script src="../javascript/orizin_ui.min.js"></script>
        <script src="../javascript/basic.js"></script>
        <script src="/eel.js"></script>
        <script>
            const ALL_CARDS = 8;
            let setup_status = 0;
            const progress = document.querySelector("progress");

            function forward_card(current_card_id, next_card_id) {
                document.getElementById(current_card_id).style.marginLeft = "-100vw";
                document.getElementById(next_card_id).style.marginLeft = "0";
                setup_status += 1;
                progress.value = setup_status / ALL_CARDS;
            }

            function back_card(current_card_id, back_card_id) {
                document.getElementById(current_card_id).style.marginLeft = "100vw";
                document.getElementById(back_card_id).style.marginLeft = "0";

                setup_status -= 1;
                progress.value = setup_status / ALL_CARDS;
            }

            async function generate_theme_menu() {
                const theme_dict = await eel.return_theme_dict()();
                const theme_select_element = document.getElementById("theme");
                for (theme_path in theme_dict) {
                    const option_element = `<option value="${theme_path}">${theme_dict[theme_path]}</option>`;
                    theme_select_element.insertAdjacentHTML("beforeend", option_element);
                }
            }

            generate_theme_menu();

            async function set_to_current_setting() {
                document.getElementById("theme").value = await eel.read_setting("theme")();
                document.getElementById("user_name").value = await eel.read_setting("user_name")();
                document.getElementById("news_site_url").value = await eel.read_setting("news_site_url")();
                document.getElementById("search_engine").search_engine_list.value = await eel.read_setting("search_engine")();
                document.getElementById("python_interpreter").value = await eel.read_setting("python_interpreter")();
            }

            set_to_current_setting();

            function save_setting() {
                eel.write_setting("setup_finished", "True");

                eel.change_theme(document.getElementById("theme").value);
                eel.write_setting("user_name", document.getElementById("user_name").value);
                eel.write_setting("news_site_url", document.getElementById("news_site_url").value);
                eel.write_setting("search_engine", document.getElementById("search_engine").value);
                eel.write_setting("python_interpreter", document.getElementById("python_interpreter").value);

                location.href = "index.html"
            }
        </script>
    </body>
</html>
